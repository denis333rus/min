{% extends "base.html" %}

{% block title %}–í–æ–µ–Ω–Ω–∞—è —Å–ª—É–∂–±–∞ - –ú–∏–Ω–æ–±–æ—Ä–æ–Ω—ã –†–æ—Å—Å–∏–∏{% endblock %}

{% block extra_css %}
<style>
.recruitment-section {
    padding: 60px 0;
    background: #f5f5f5;
}

.recruitment-container {
    max-width: 800px;
    margin: 0 auto;
    background: white;
    padding: 40px;
    border-radius: 10px;
    box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
}

.recruitment-header {
    text-align: center;
    margin-bottom: 40px;
}

.recruitment-header h1 {
    font-size: 36px;
    color: #1a1a1a;
    margin-bottom: 10px;
}

.recruitment-header p {
    color: #666;
    font-size: 18px;
}

.recruitment-form {
    max-width: 600px;
    margin: 0 auto;
}

.form-group {
    margin-bottom: 25px;
}

.form-group label {
    display: block;
    margin-bottom: 8px;
    font-weight: bold;
    color: #333;
    font-size: 14px;
}

.form-group label .required {
    color: red;
}

.form-group input,
.form-group textarea,
.form-group select {
    width: 100%;
    padding: 12px;
    border: 2px solid #ddd;
    border-radius: 5px;
    font-size: 16px;
    transition: border-color 0.3s;
}

.form-group input:focus,
.form-group textarea:focus,
.form-group select:focus {
    outline: none;
    border-color: #ffd700;
}

.form-group textarea {
    resize: vertical;
    min-height: 100px;
}

.form-row {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 20px;
}

.recruitment-info {
    background: #fff9e6;
    border-left: 4px solid #ffd700;
    padding: 20px;
    margin-bottom: 30px;
    border-radius: 5px;
}

.recruitment-info h3 {
    color: #1a1a1a;
    margin-bottom: 10px;
}

.recruitment-info ul {
    margin-left: 20px;
    color: #666;
}

.submit-button {
    background: linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%);
    color: white;
    padding: 15px 40px;
    border: none;
    border-radius: 5px;
    font-size: 18px;
    font-weight: bold;
    cursor: pointer;
    width: 100%;
    transition: transform 0.2s;
}

.submit-button:hover {
    transform: translateY(-2px);
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
}

.message {
    padding: 15px;
    margin-bottom: 20px;
    border-radius: 5px;
    text-align: center;
    font-weight: bold;
}

.message.success {
    background: #d4edda;
    color: #155724;
    border: 1px solid #c3e6cb;
}

.message.error {
    background: #f8d7da;
    color: #721c24;
    border: 1px solid #f5c6cb;
}

@media (max-width: 768px) {
    .form-row {
        grid-template-columns: 1fr;
    }
    
    .recruitment-container {
        padding: 20px;
    }
}
</style>
{% endblock %}

{% block content %}
<section class="recruitment-section">
    <div class="recruitment-container">
        <div class="recruitment-header">
            <h1>üìã –ó–∞—è–≤–∫–∞ –Ω–∞ –≤–æ–µ–Ω–Ω—É—é —Å–ª—É–∂–±—É</h1>
            <p>–ó–∞–ø–æ–ª–Ω–∏—Ç–µ —Ñ–æ—Ä–º—É –¥–ª—è –ø–æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –Ω–∞ —Å–ª—É–∂–±—É</p>
        </div>

        <div class="recruitment-info">
            <h3>üìå –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –∫–∞–Ω–¥–∏–¥–∞—Ç–∞–º:</h3>
            <ul>
                <li>–í–æ–∑—Ä–∞—Å—Ç –æ—Ç 18 –¥–æ 27 –ª–µ—Ç</li>
                <li>–ì–æ–¥–Ω–æ—Å—Ç—å –∫ –≤–æ–µ–Ω–Ω–æ–π —Å–ª—É–∂–±–µ</li>
            </ul>
        </div>

        <div id="message-container"></div>

        <form class="recruitment-form" id="recruitment-form">
            <h3 style="margin-bottom: 30px; color: #1a1a1a;">–õ–∏—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ</h3>
            
            <div class="form-row">
                <div class="form-group">
                    <label>–§–∞–º–∏–ª–∏—è(–†–ü –ø–µ—Ä—Å–æ–Ω–∞–∂–∞) <span class="required">*</span></label>
                    <input type="text" name="last_name" required>
                </div>
                <div class="form-group">
                    <label>–ò–º—è(–†–ü –ø–µ—Ä—Å–æ–Ω–∞–∂–∞) <span class="required">*</span></label>
                    <input type="text" name="first_name" required>
                </div>
            </div>

            <div class="form-group">
                <label>–û—Ç—á–µ—Å—Ç–≤–æ(–†–ü –ø–µ—Ä—Å–æ–Ω–∞–∂–∞)</label>
                <input type="text" name="middle_name">
            </div>

            <div class="form-group">
                <label>–î–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è –†–ü –ø–µ—Ä—Å–æ–Ω–∞–∂–∞<span class="required">*</span></label>
                <input type="date" name="birth_date" required>
            </div>

            <div class="form-group">
                <label>–°–∫–æ–ª—å–∫–æ –≤–∞–º –ª–µ—Ç (–û–°–°)?<span class="required">*</span></label>
                <input type="number" name="r_age" min="13" max="99" required placeholder="–í–∞—à —Ä–µ–∞–ª—å–Ω—ã–π –≤–æ–∑—Ä–∞—Å—Ç">
            </div>
            
            <div class="form-group">
                <label>–°–∫–æ–ª—å–∫–æ –≤—ã –Ω–∞ –ø—Ä–æ–µ–∫—Ç–µ?<span class="required">*</span></label>
                <input type="text" name="time_on_project" required placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: 2 –º–µ—Å—è—Ü–∞">
            </div>
            
            <div class="form-group">
                <label>–ë—ã–ª –ª–∏ —É –≤–∞—Å –æ–ø—ã—Ç –≤ –ø–æ–¥–æ–±–Ω—ã—Ö —Ñ—Ä–∞–∫—Ü–∏—è—Ö?<span class="required">*</span></label>
                <select name="previous_faction_experience" required>
                    <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –æ—Ç–≤–µ—Ç</option>
                    <option value="–î–∞, –±—ã–ª –±–æ–ª—å—à–æ–π –æ–ø—ã—Ç">–î–∞, –±—ã–ª –±–æ–ª—å—à–æ–π –æ–ø—ã—Ç</option>
                    <option value="–î–∞, –±—ã–ª –Ω–µ–±–æ–ª—å—à–æ–π –æ–ø—ã—Ç">–î–∞, –±—ã–ª –Ω–µ–±–æ–ª—å—à–æ–π –æ–ø—ã—Ç</option>
                    <option value="–ù–µ—Ç –æ–ø—ã—Ç–∞">–ù–µ—Ç –æ–ø—ã—Ç–∞</option>
                </select>
            </div>
            
            <div class="form-group">
                <label>–í–∞—à–∏ –Ω–∞–≤—ã–∫–∏ —Å—Ç—Ä–µ–ª—å–±—ã (1-10)<span class="required">*</span></label>
                <input type="number" name="shooting_skills" min="1" max="10" required placeholder="–û—Ü–µ–Ω–∏—Ç–µ –æ—Ç 1 –¥–æ 10">
            </div>
            
            <div class="form-group">
                <label>–ù–∞—Å–∫–æ–ª—å–∫–æ –≤—ã –∑–Ω–∞–∫–æ–º—ã —Å –£–ö –†–§ –∏ –£—Å—Ç–∞–≤–æ–º?<span class="required">*</span></label>
                <textarea name="knowledge_of_law" required placeholder="–û–ø–∏—à–∏—Ç–µ –≤–∞—à —É—Ä–æ–≤–µ–Ω—å –∑–Ω–∞–Ω–∏–π"></textarea>
            </div>


            <h3 style="margin: 40px 0 20px 0; color: #1a1a1a;">–î–æ–∫—É–º–µ–Ω—Ç—ã</h3>


            <h3 style="margin: 40px 0 20px 0; color: #1a1a1a;">–ö–æ–Ω—Ç–∞–∫—Ç–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h3>

            <div class="form-group">
                <label>–ù–∏–∫ –≤ Discord <span class="required">*</span></label>
                <input type="text" name="phone" required placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: user">
            </div>

            <div class="form-group">
                <label>–ù–∏–∫ –≤ Roblox</label>
                <input type="text" name="roblox_nick" placeholder="–í–∞—à –Ω–∏–∫ –≤ –∏–≥—Ä–µ">
            </div>

            <h3 style="margin: 40px 0 20px 0; color: #1a1a1a;">–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h3>

            <div class="form-group">
                <label>–°–∫–æ–ª—å–∫–æ –ø—Ä–æ–∂–∏–≤–∞–µ—Ç–µ –≤ –æ–±–ª–æ—Å—Ç–∏</label>
                <input type="text" name="live_in_area" placeholder="–°–∫–æ–ª—å–∫–æ –ø—Ä–æ–∂–∏–≤–∞–µ—Ç–µ –≤ –æ–±–ª–æ—Å—Ç–∏">
            </div>
            <div class="form-group">
                <label>–ì–æ—Ç–æ–≤—ã –æ—Ç–¥–∞—Ç—å –¥–æ–ª–≥ —Ä–æ–¥–∏–Ω–µ?</label>
                <select name="ready_to_serve_the_country">
                    <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –æ—Ç–≤–µ—Ç</option>
                    <option value="–î–∞, –≥–æ—Ç–æ–≤">–î–∞, –≥–æ—Ç–æ–≤</option>
                    <option value="–ù–µ—Ç, –Ω–µ –≥–æ—Ç–æ–≤">–ù–µ—Ç, –Ω–µ –≥–æ—Ç–æ–≤</option>
                </select>
            </div>

            <div class="form-group">
                <label>–ü—Ä–µ–¥—ã–¥—É—â–∞—è —Å–ª—É–∂–±–∞ (–µ—Å–ª–∏ –∏–º–µ–µ—Ç—Å—è)</label>
                <textarea name="previous_service" placeholder="–ó–≤–∞–Ω–∏–µ, –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ, –ø–µ—Ä–∏–æ–¥ —Å–ª—É–∂–±—ã"></textarea>
            </div>

            <div class="form-group">
                <label>–ñ–µ–ª–∞–µ–º–æ–µ –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ</label>
                <select name="department_preference">
                    <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ</option>
                    <option value="–°—É—Ö–æ–ø—É—Ç–Ω—ã–µ –≤–æ–π—Å–∫–∞">–°—É—Ö–æ–ø—É—Ç–Ω—ã–µ –≤–æ–π—Å–∫–∞</option>
                    <option value="–í–æ–∑–¥—É—à–Ω–æ-–∫–æ—Å–º–∏—á–µ—Å–∫–∏–µ —Å–∏–ª—ã">–í–æ–∑–¥—É—à–Ω–æ-–∫–æ—Å–º–∏—á–µ—Å–∫–∏–µ —Å–∏–ª—ã</option>
                    <option value="–í–æ–µ–Ω–Ω–æ-–º–æ—Ä—Å–∫–æ–π —Ñ–ª–æ—Ç">–í–æ–µ–Ω–Ω–æ-–º–æ—Ä—Å–∫–æ–π —Ñ–ª–æ—Ç</option>
                    <option value="–í–æ–∑–¥—É—à–Ω–æ-–¥–µ—Å–∞–Ω—Ç–Ω—ã–µ –≤–æ–π—Å–∫–∞">–í–æ–∑–¥—É—à–Ω–æ-–¥–µ—Å–∞–Ω—Ç–Ω—ã–µ –≤–æ–π—Å–∫–∞</option>
                </select>
            </div>
            <div class="form-group">
                <label>–ö–∞–∫—É—é —Å–ª—É–∂–±—É –≤—ã–±–µ—Ä–µ—Ç–µ?<span class="required">*</span></label>
                <select name="service_type" required>
                    <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –æ—Ç–≤–µ—Ç</option>
                    <option value="conscription">–°—Ä–æ—á–Ω–∞—è —Å–ª—É–∂–±–∞ (–≤–æ–µ–Ω–Ω—ã–π –±–∏–ª–µ—Ç)</option>
                    <option value="contract">–ö–æ–Ω—Ç—Ä–∞–∫—Ç (–∫–∞—Ä—å–µ—Ä–Ω—ã–π —Ä–æ—Å—Ç)</option>
                </select>
            </div>

            <div class="form-group">
                <label>–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</label>
                <textarea name="additional_info"></textarea>
            </div>

            <h3 style="margin: 40px 0 20px 0; color: #1a1a1a;">–£—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ</h3>

            <div class="form-group">
                <label>–ñ–µ–ª–∞–µ–º—ã–π –ª–æ–≥–∏–Ω <span class="required">*</span></label>
                <input type="text" name="username" required minlength="3" placeholder="–ü—Ä–∏–¥—É–º–∞–π—Ç–µ –ª–æ–≥–∏–Ω">
            </div>
            <div class="form-group">
                <label>–ñ–µ–ª–∞–µ–º—ã–π –ø–∞—Ä–æ–ª—å <span class="required">*</span></label>
                <input type="password" name="password" required minlength="6" placeholder="–ü—Ä–∏–¥—É–º–∞–π—Ç–µ –ø–∞—Ä–æ–ª—å (–Ω–µ –º–µ–Ω–µ–µ 6 —Å–∏–º–≤–æ–ª–æ–≤)">
            </div>

            <button type="submit" class="submit-button">üì§ –û—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞—è–≤–∫—É</button>
        </form>
    </div>
</section>
{% endblock %}

{% block extra_js %}
<script>
document.getElementById('recruitment-form').addEventListener('submit', async function(e) {
    e.preventDefault();
    
    const formData = new FormData(this);
    const data = {};
    formData.forEach((value, key) => {
        data[key] = value;
    });
    
    const submitButton = this.querySelector('.submit-button');
    const originalText = submitButton.textContent;
    submitButton.textContent = '‚è≥ –û—Ç–ø—Ä–∞–≤–∫–∞...';
    submitButton.disabled = true;
    
    try {
        const response = await fetch('/recruitment/submit', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify(data)
        });
        
        const result = await response.json();
        
        const messageContainer = document.getElementById('message-container');
        if (result.success) {
            if (result.show_credentials && result.username && result.password) {
                // –ü–æ–∫–∞–∑–∞—Ç—å –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å —É—á–µ—Ç–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
                showCredentialsModal(result.username, result.password);
            } else {
                messageContainer.innerHTML = `<div class="message success">‚úÖ ${result.message}</div>`;
            }
            this.reset();
            window.scrollTo({ top: 0, behavior: 'smooth' });
        } else {
            messageContainer.innerHTML = `<div class="message error">‚ùå ${result.message}</div>`;
        }
    } catch (error) {
        const messageContainer = document.getElementById('message-container');
        messageContainer.innerHTML = `<div class="message error">‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ: ${error.message}</div>`;
    } finally {
        submitButton.textContent = originalText;
        submitButton.disabled = false;
    }
});

function showCredentialsModal(username, password) {
    const modal = document.createElement('div');
    modal.className = 'credentials-modal';
    modal.innerHTML = `
        <div class="credentials-content">
            <h2>üéâ –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–∞!</h2>
            <p style="color: #666; margin-bottom: 20px;">–í–∞—à–∏ —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –≤—Ö–æ–¥–∞ –≤ —Å–∏—Å—Ç–µ–º—É:</p>
            <div class="credentials-box">
                <div class="credential-item">
                    <label>–õ–æ–≥–∏–Ω:</label>
                    <code>${username}</code>
                </div>
                <div class="credential-item">
                    <label>–ü–∞—Ä–æ–ª—å:</label>
                    <code>${password}</code>
                </div>
            </div>
            <p style="color: #ff6b6b; margin-top: 20px; font-weight: bold;">‚ö†Ô∏è –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ —ç—Ç–∏ –¥–∞–Ω–Ω—ã–µ –≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ–º –º–µ—Å—Ç–µ!</p>
            <button onclick="this.closest('.credentials-modal').remove()" class="submit-button" style="margin-top: 20px;">–ó–∞–∫—Ä—ã—Ç—å</button>
        </div>
    `;
    
    // –î–æ–±–∞–≤–ª—è–µ–º —Å—Ç–∏–ª–∏ –¥–ª—è –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞
    if (!document.getElementById('credentials-styles')) {
        const style = document.createElement('style');
        style.id = 'credentials-styles';
        style.textContent = `
            .credentials-modal {
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0, 0, 0, 0.7);
                display: flex;
                justify-content: center;
                align-items: center;
                z-index: 9999;
            }
            .credentials-content {
                background: white;
                padding: 40px;
                border-radius: 15px;
                max-width: 500px;
                box-shadow: 0 10px 50px rgba(0, 0, 0, 0.3);
                text-align: center;
            }
            .credentials-content h2 {
                color: #1a1a1a;
                margin-bottom: 20px;
            }
            .credentials-box {
                background: #f9f9f9;
                padding: 20px;
                border-radius: 10px;
                margin: 20px 0;
                border: 2px solid #ffd700;
            }
            .credential-item {
                margin: 15px 0;
                text-align: left;
            }
            .credential-item label {
                display: block;
                font-weight: bold;
                color: #333;
                margin-bottom: 5px;
            }
            .credential-item code {
                display: block;
                background: white;
                padding: 10px;
                border-radius: 5px;
                font-size: 16px;
                font-family: 'Courier New', monospace;
                color: #1a1a1a;
                border: 1px solid #ddd;
                word-break: break-all;
            }
        `;
        document.head.appendChild(style);
    }
    
    document.body.appendChild(modal);
}
</script>
{% endblock %}

